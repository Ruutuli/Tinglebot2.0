<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tinglebot - Zelda Realm Map</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="css/map.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body class="map-page">
    <!-- Loading Overlay -->
    <div class="map-loading-overlay" id="map-loading-overlay">
        <div class="loading-container">
            <div class="loading-content">
                <div class="map-loading-spinner"></div>
                <div class="map-loading-text">Loading ROTW Map</div>
                <div class="map-loading-subtitle" id="loading-subtitle">Initializing map system...</div>
                <div class="loading-progress-container">
                    <div class="loading-progress-bar">
                        <div class="loading-progress-fill" id="loading-progress-fill"></div>
                    </div>
                    <div class="loading-progress-text" id="loading-progress-text">0%</div>
                </div>
                <div class="loading-steps" id="loading-steps">
                    <div class="loading-step active" id="step-1">
                        <i class="fas fa-cog fa-spin"></i>
                        <span>Initializing system...</span>
                    </div>
                    <div class="loading-step" id="step-2">
                        <i class="fas fa-map"></i>
                        <span>Loading map data...</span>
                    </div>
                    <div class="loading-step" id="step-3">
                        <i class="fas fa-layer-group"></i>
                        <span>Preparing layers...</span>
                    </div>
                    <div class="loading-step" id="step-4">
                        <i class="fas fa-check"></i>
                        <span>Ready to explore!</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Map Container -->
    <div id="map"></div>
    
    
    <!-- Permanent Sidebar -->
    <div class="side-ui">
        <div class="ui-content">
            <div class="ui-header">
                <div class="header-content">
                    <div class="header-title">
                        <div class="title-main">
                            <i class="fas fa-seedling"></i>
                            <h2>Roots of the Wild Map</h2>
                        </div>
                        <p class="title-subtitle">Interactive Realm Explorer</p>
                    </div>
                    <div class="header-actions">
                        <button class="action-btn dashboard-btn" onclick="window.location.href='/'" title="Back to Dashboard">
                            <i class="fas fa-home"></i>
                            <span>Dashboard</span>
                        </button>
                    </div>
                </div>
            </div>
            

            <!-- Zoom Controls -->
            <div class="zoom-section collapsible-section">
                <h3 class="section-header" onclick="toggleSection('zoom-section')">
                    <i class="fas fa-search-plus"></i> Zoom Controls
                    <i class="fas fa-chevron-down section-arrow"></i>
                </h3>
                <div class="section-content">
                    <div class="zoom-buttons">
                        <button class="zoom-btn zoom-in" onclick="zoomIn()" title="Zoom In">
                            <i class="fas fa-plus"></i>
                        </button>
                        <button class="zoom-btn zoom-out" onclick="zoomOut()" title="Zoom Out">
                            <i class="fas fa-minus"></i>
                        </button>
                        <button class="zoom-btn zoom-reset" onclick="resetZoom()" title="Reset Zoom">
                            <i class="fas fa-home"></i>
                        </button>
                    </div>
                    <div class="village-nav">
                        <h4><i class="fas fa-map-marker-alt"></i> Quick Village Access</h4>
                        <div class="village-buttons-horizontal">
                            <button class="village-btn-compact fire-village" onclick="jumpToVillage('H5', 'Rudania')" title="Jump to Rudania (H5)">
                                <span class="village-emoji">üî•</span>
                            </button>
                            <button class="village-btn-compact water-village" onclick="jumpToVillage('H8', 'Inariko')" title="Jump to Inariko (H8)">
                                <span class="village-emoji">üíß</span>
                            </button>
                            <button class="village-btn-compact leaf-village" onclick="jumpToVillage('F10', 'Vhintl')" title="Jump to Vhintl (F10)">
                                <span class="village-emoji">üçÉ</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Map Layer Controls -->
            <div class="layer-controls-section collapsible-section">
                <h3 class="section-header" onclick="toggleSection('layer-controls-section')">
                    <i class="fas fa-layer-group"></i> Map Layers
                    <i class="fas fa-chevron-down section-arrow"></i>
                </h3>
                <div class="section-content">
                    <div id="map-layer-toggles"></div>
                </div>
            </div>

            <!-- Pins Section -->
            <div class="pins-section collapsible-section">
                <h3 class="section-header" onclick="toggleSection('pins-section')">
                    <i class="fas fa-map-pin"></i> Pins
                    <i class="fas fa-chevron-down section-arrow"></i>
                </h3>
                <div class="section-content">
                    <div class="pins-controls">
                        <div class="pin-actions">
                            <button class="pin-btn add-pin-btn" onclick="toggleAddPinMode()" title="Add New Pin">
                                <i class="fas fa-plus"></i>
                                <span>Add Pin</span>
                            </button>
                        </div>
                        
                        <div class="pin-search">
                            <h4><i class="fas fa-search"></i> Search Pins</h4>
                            <div class="search-container">
                                <input type="text" id="pin-search-input" placeholder="Search pins by name or description..." class="search-input">
                                <button id="clear-search-btn" class="clear-search-btn" title="Clear search">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="pins-list" id="pins-list">
                            <!-- Pins will be loaded dynamically -->
                        </div>
                        
                        <div class="pin-categories">
                            <h4><i class="fas fa-tags"></i> Pin Categories</h4>
                            <div class="category-filters">
                                <button class="category-filter active" data-category="all">All</button>
                                <button class="category-filter" data-category="my-pins">My Pins</button>
                                <button class="category-filter" data-category="homes">Homes</button>
                                <button class="category-filter" data-category="farms">Farms</button>
                                <button class="category-filter" data-category="shops">Shops</button>
                                <button class="category-filter" data-category="points-of-interest">Points of Interest</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- User Features (Future) -->
            <div class="user-features-section collapsible-section">
                <h3 class="section-header" onclick="toggleSection('user-features-section')">
                    <i class="fas fa-magic"></i> Explorer Tools
                    <i class="fas fa-chevron-down section-arrow"></i>
                </h3>
                <div class="section-content">
                    <div class="explorer-tools-content">
                        <div class="exploration-tool-item">
                            <button class="exploration-tool-btn" onclick="toggleExplorationMode()">
                                <i class="fas fa-map-marked-alt"></i>
                                <div class="tool-content">
                                    <span>Exploration Mode</span>
                                    <small>Add markers and paths</small>
                                </div>
                            </button>
                        </div>
                        
                        <!-- Exploration Panel (hidden by default) -->
                        <div id="exploration-panel" class="exploration-panel-inline" style="display: none;">
                            <div class="exploration-content">
                                <div class="exploration-section">
                                    <label for="exploration-id">Exploration ID:</label>
                                    <input type="text" id="exploration-id" placeholder="E123456" maxlength="10">
                                    <button onclick="setExplorationId()">Set ID</button>
                                </div>
                                <div class="exploration-section">
                                    <h4>Add Markers</h4>
                                    <div class="marker-buttons">
                                        <button onclick="setMarkerType('ruins')" class="marker-btn ruins">
                                            <img src="https://storage.googleapis.com/tinglebot/maps/ruinrestcamproots2024.png" alt="Ruins">
                                            <span>Ruins</span>
                                        </button>
                                        <button onclick="setMarkerType('monster')" class="marker-btn monster">
                                            <img src="https://storage.googleapis.com/tinglebot/maps/monstercamproots2024.png" alt="Monster">
                                            <span>Monster</span>
                                        </button>
                                        <button onclick="setMarkerType('grotto')" class="marker-btn grotto">
                                            <img src="https://storage.googleapis.com/tinglebot/maps/grottoiconroots2024.png" alt="Grotto">
                                            <span>Grotto</span>
                                        </button>
                                    </div>
                                </div>
                            <div class="exploration-section">
                                <h4>Current ID: <span id="current-id-display">None</span></h4>
                                <div class="exploration-status">
                                    <span id="exploration-mode-status">Click map to add markers</span>
                                </div>
                            </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
        </div>
    </div>
    
    <!-- UI Toggle Button -->
    <button class="ui-toggle" onclick="toggleSidebar()">
        <i class="fas fa-chevron-right"></i>
    </button>

    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    
    <!-- Map System Modules -->
    <script src="js/map-constants.js"></script>
    <script src="js/map-metadata.js"></script>
    <script src="js/map-geometry.js"></script>
    <script src="js/map-manifest.js"></script>
    <script src="js/map-layers.js"></script>
    <script src="js/map-loader.js"></script>
    <script src="js/map-toggles.js"></script>
    <script src="js/map-engine.js"></script>
    
    <!-- Main Map Integration -->
    <script src="js/map.js"></script>
</body>
</html>